@model web.ViewModels.StatisticViewModel
@{
    ViewBag.Title = "Customer Report";
}

<div class="container-fluid">
    <p>
        <a asp-action="Create" asp-controller="Email" asp-route-count="@Model.NumOfPurchases"><button class="btn btn-default" @*onclick="SendEmail('@Model.NumOfPurchases')"*@>Send Email</button></a>
    </p>
    <table class="table table-responsive table-hover">
        <thead>
            <tr>
                <th scope="row">
                    First Name
                </th>
                <th scope="row">
                    Last Name
                </th>
                <th scope="row">
                    Email
                </th>
                <th scope="row">
                    Phone Number
                </th>
            </tr>
        </thead>
        <tbody>
            @foreach (var customer in Model.Users)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(c => customer.ApplicationUserFirstName)
                    </td>
                    <td>
                        @Html.DisplayFor(c => customer.ApplicationUserLastName)
                    </td>
                    <td>
                        @Html.DisplayFor(c => customer.ApplicationUserEmail)
                    </td>
                    <td>
                        @Html.DisplayFor(c => customer.ApplicationUserPhoneNumber)
                    </td>
                </tr>    
            }
        </tbody>
    </table>
</div>

<script>    
    var SendEmail = function (count) {
        var url = "/Email/Create/?count=" + count;
        
        $("#send-email-modal-dialog").load(url,
            function() {
                $("#send-email-modal").modal("show");
            });
    }
</script>
